$(function(){if("auth/login"==$("body").data("location")){$("#form-login").validator({rules:{name:"required|userName",password:"required"}}).submit(function(){if(!$(this).data("instance.validator").isValid())return!1;var i=$('button[type="submit"]',$(this));return i.loading("start"),$.http.post("/auth/login",$.getValByNames(["name","password"]),{progress:!0,success:function(i,a,e){if(i.hasTeamAccounts)return t();i.hasEsCluster?$.message.tip("登录成功",function(){window.location.href="/setting/es"}):$.message.tip("登录成功",function(){window.location.href="/auth/es"})},error:function(t,i,a){$.message.warn(a)},complete:function(){i.loading("done")}}),!1});var t=function(){$("#form-login").addClass("animation-fadeOutLeft"),$(".description span").text("登录成功, 请选择进入的帐号"),$.http.get("/team/accounts",{},{success:function(t){for(var i="",a=0;a<t.team.length;a++)i+='<dd class="account-item" data-id="'+t.team[a].id+'">'+t.team[a].name+' <i class="iconfont icon-right"></i></dd>';var e='<dd class="account-item" data-id="'+t.prototype.id+'">'+t.prototype.name+' <i class="iconfont icon-right"></i></dd>';$("#form-select-account .team-accounts").append(i),$("#form-select-account .user-accounts").append(e),window.setTimeout(function(){$("#form-login").hide(),$("#form-select-account").addClass("animation-fadeInRight").show()},400)},error:function(t,i,a){$.message.warn(a)}})};$("#form-select-account").on("click",".account-item",function(){$.http.get("/auth/switch/"+$(this).data("id"))})}}),$(function(){"auth/es"==$("body").data("location")&&($('[name="protocol"]').select({placeholder:"请选择协议"}),$("#form-esCluster").validator({rules:{protocol:"required",host:"required",port:"required|int"}}).submit(function(){if(!$(this).data("instance.validator").isValid())return!1;var t=$('button[type="submit"]',$(this));return t.loading("start"),$.http.post("/es/cluster",{id:"",url:$.getValByName("protocol",$(this))+"://"+$.getValByName("host",$(this))+":"+$.getValByName("port",$(this))},{success:function(){$.message.tip("设置成功",function(){window.location.href="/setting/es"})},error:function(t,i,a){$.message.warn(a)},complete:function(){t.loading("done")}}),!1}))}),$(function(){"use strict";function t(t,i){if(arguments.length<2&&(i=t,t=0),t>i){var a=i;i=t,t=a}return Math.floor(Math.random()*(i-t+1))+t}function i(t,i){var a=Math.max(t,i);return Math.round(Math.sqrt(a*a+a*a))/2}function a(){o.globalCompositeOperation="source-over",o.globalAlpha=.8,o.fillStyle="hsla("+r+", 64%, 6%, 1)",o.fillRect(0,0,s,n),o.globalCompositeOperation="lighter";for(var t=1,i=d.length;t<i;t++)d[t].draw();window.requestAnimationFrame(a)}var e=document.getElementById("bg-login");if(e){var o=e.getContext("2d"),s=e.width=window.innerWidth,n=e.height=window.innerHeight,r=217,d=[],c=0,h=document.createElement("canvas"),l=h.getContext("2d");h.width=100,h.height=100;var u=h.width/2,f=l.createRadialGradient(u,u,0,u,u,u);f.addColorStop(.025,"#fff"),f.addColorStop(.1,"hsl("+r+", 61%, 33%)"),f.addColorStop(.25,"hsl("+r+", 64%, 6%)"),f.addColorStop(1,"transparent"),l.fillStyle=f,l.beginPath(),l.arc(u,u,u,0,2*Math.PI),l.fill();var m=function(){this.orbitRadius=t(i(s,n)),this.radius=t(60,this.orbitRadius)/12,this.orbitX=s/2,this.orbitY=n/2,this.timePassed=t(0,1200),this.speed=t(this.orbitRadius)/9e5,this.alpha=t(2,10)/10,d[++c]=this};m.prototype.draw=function(){var i=Math.sin(this.timePassed)*this.orbitRadius+this.orbitX,a=Math.cos(this.timePassed)*this.orbitRadius+this.orbitY,e=t(10);1===e&&this.alpha>0?this.alpha-=.05:2===e&&this.alpha<1&&(this.alpha+=.05),o.globalAlpha=this.alpha,o.drawImage(h,i-this.radius/2,a-this.radius/2,this.radius,this.radius),this.timePassed+=this.speed};for(var p=0;p<1200;p++)new m;a()}});